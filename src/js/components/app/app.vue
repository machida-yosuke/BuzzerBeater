<template lang="pug">
  .app-wrap(v-bind:style='[backgroundColor, {background}]' v-on:click='enableMicroPhone')
    .app-wrap__megaphone
      <svg version="1.1" id="レイヤー_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 779.6 1380" style="enable-background:new 0 0 779.6 1380;" xml:space="preserve">
      <g v-bind:data-color='megaphoneColor'>
        <path class="st0" d="M539.2,1181.2c-9.7-27.1-19.4-54.1-29.1-81.1L779.6,198c-0.9,3.1-2,6.1-3.2,9.2c-0.6,1.4-1.2,2.8-1.8,4.2c-0.1,0.1-0.1,0.2-0.2,0.4c-0.6,1.4-1.2,2.7-1.9,4c-0.1,0.2-0.2,0.3-0.2,0.5c-0.7,1.3-1.4,2.7-2.1,4c-0.1,0.1-0.1,0.3-0.2,0.4c-0.7,1.4-1.5,2.7-2.3,4c0,0.1-0.1,0.1-0.1,0.2c-24.2,40.1-73.4,73.7-137.5,97.4c-31.8,11.8-67.2,21.2-105,27.7c-0.7,0.1-1.5,0.3-2.2,0.4c-2.4,0.4-4.8,0.8-7.1,1.2c-1.6,0.2-3.1,0.5-4.7,0.7c-1.5,0.2-3,0.4-4.4,0.7c-2.6,0.4-5.2,0.7-7.8,1.1c-0.1,0-0.2,0-0.3,0c-19.8,2.6-40.1,4.5-60.8,5.6c-0.1,0-0.1,0-0.2,0c-2.8,0.1-5.6,0.3-8.4,0.4c-0.8,0-1.6,0.1-2.4,0.1c-2.1,0.1-4.3,0.2-6.4,0.2c-1.4,0-2.8,0.1-4.2,0.1c-1.6,0-3.2,0.1-4.9,0.1c-1.8,0-3.7,0.1-5.5,0.1c-1.2,0-2.5,0-3.7,0c-2.2,0-4.3,0-6.5,0c-1,0-2,0-3,0c-2.4,0-4.8,0-7.2-0.1c-0.8,0-1.6,0-2.4,0c-2.6,0-5.1-0.1-7.7-0.2c-0.7,0-1.3,0-2-0.1c-2.7-0.1-5.3-0.2-8-0.3c-0.6,0-1.2,0-1.8-0.1c-2.7-0.1-5.5-0.2-8.3-0.4c-0.5,0-1-0.1-1.6-0.1c-2.8-0.2-5.7-0.3-8.5-0.5c-0.4,0-0.9-0.1-1.3-0.1c-2.9-0.2-5.8-0.4-8.8-0.6c-0.3,0-0.7-0.1-1-0.1c-3-0.2-6.1-0.5-9.1-0.8c-0.2,0-0.4,0-0.6-0.1c-3.2-0.3-6.5-0.6-9.7-0.9C145.4,339.2,22.9,271.1,0,191.6c87.1,302.2,174.3,604.3,261.4,906.5l-62.7,169.4c-20.1,50.4,47,99.9,149.8,110.5l0,0c1.7,0.2,3.3,0.3,5,0.5c0.6,0.1,1.1,0.1,1.7,0.1c1.1,0.1,2.1,0.2,3.2,0.3c0.9,0.1,1.9,0.1,2.8,0.2c0.7,0,1.4,0.1,2.1,0.1c1.1,0.1,2.2,0.1,3.3,0.2c0.5,0,1,0.1,1.6,0.1c1.2,0.1,2.4,0.1,3.6,0.2c0.4,0,0.8,0,1.2,0.1c1.3,0.1,2.6,0.1,3.9,0.1c0.3,0,0.6,0,0.9,0c1.4,0,2.8,0.1,4.1,0.1c0.2,0,0.4,0,0.6,0c1.5,0,3,0,4.4,0c0,0,0.1,0,0.1,0c14.2,0,28.1-0.7,41.5-2.1c41.6-4.5,78.7-15.9,105.2-32.1c2.9-1.8,5.7-3.6,8.3-5.5c0.2-0.1,0.4-0.3,0.6-0.4c0.7-0.5,1.3-1,2-1.4c0.3-0.2,0.5-0.4,0.8-0.6c0.6-0.5,1.2-0.9,1.8-1.4c0.3-0.2,0.5-0.4,0.8-0.6c0.6-0.5,1.2-1,1.8-1.5c0.2-0.1,0.3-0.3,0.5-0.4c1.2-1,2.3-2.1,3.5-3.1c0.2-0.2,0.4-0.4,0.6-0.6c0.5-0.4,0.9-0.9,1.3-1.3c0.3-0.3,0.6-0.6,0.9-0.9c0.4-0.4,0.8-0.8,1.2-1.3c0.3-0.4,0.7-0.7,1-1.1c0.4-0.4,0.7-0.8,1.1-1.2c0.3-0.4,0.7-0.8,1-1.2c0.3-0.4,0.6-0.8,1-1.2c0.4-0.5,0.8-1,1.2-1.6c0.3-0.4,0.7-0.9,1-1.3c0.4-0.6,0.9-1.2,1.3-1.8c0.2-0.3,0.4-0.7,0.6-1c0.3-0.5,0.6-1,1-1.5c0.2-0.3,0.4-0.7,0.6-1c0.3-0.5,0.6-1,0.9-1.5c0.2-0.3,0.4-0.7,0.5-1c0.3-0.6,0.6-1.1,0.8-1.7c0.1-0.3,0.3-0.6,0.4-0.9c0.4-0.9,0.8-1.7,1.1-2.6c4.6-11.6,4.6-23.1,0.7-34.1C560.9,1241.7,550,1211.4,539.2,1181.2z"/>
        <path class="st0" d="M23,164.7c0-8.6,1.8-17.4,5.3-26.3C61.5,55.3,243.6-18.4,462.1,4.1c184.6,19.1,294.8,99.3,294.8,165.7c0,8.6-1.8,17.4-5.3,26.3c-33.1,83.1-215.3,156.8-433.7,134.3C133.3,311.3,23,231.1,23,164.7L23,164.7z"/>
      </g>
      </svg>
</template>

<script>
import { mapGetters, mapMutations, mapState } from 'vuex';
import { accelerationManager } from '../../module/accelerationManager';
import { microphone } from '../../module/UserMediaManager';
export default {
  name: 'app',
  mounted(){
    accelerationManager.setAcceleration();
    accelerationManager.on('Shake0',()=>{
      this.changeColor0();
    });
    accelerationManager.on('Shake1',()=>{
      this.changeColor1();
    });
    accelerationManager.on('Shake2',()=>{
      this.changeColor2();
    });
    accelerationManager.on('Shake3',()=>{
      this.changeColor3();
    });
    accelerationManager.on('Shake4',()=>{
      this.changeColor4();
    });
    microphone.on('support0',()=>{
      this.changeColor0();
    })
    microphone.on('support1',()=>{
      this.changeColor1();
    })
    microphone.on('support2',()=>{
      this.changeColor2();
    })
    microphone.on('support3',()=>{
      this.changeColor3();
    })
    microphone.on('support4',()=>{
      this.changeColor4();
    })
  },
  data(){
    return{
      background:'#000',
    }
  },
  computed: {
    ...mapState([
      'megaphoneColor'
    ])
  },
  methods: {
    ...mapMutations([
      'changeColor0',
      'changeColor1',
      'changeColor2',
      'changeColor3',
      'changeColor4',
    ]),
    enableMicroPhone(){
      console.log('on');
      microphone.initAudioContext();
    }
  }
}
</script>

<style lang="scss">
  .app-wrap{
    position: absolute;
    width: 100%;
    height: 100%;
    background: #000;
    &__megaphone{
      position: absolute;
      width: 779px;
      height: 1380px;
      transform: translate(-50%,-50%);
      left: 50%;
      top: 50%;
    }
  }

  [data-color='0']{
    fill:#ff0000;
  }
  [data-color='1']{
    fill:#ffff00;
  }
  [data-color='2']{
    fill:#00ff00;
  }
  [data-color='3']{
    fill:#00ffff;
  }
  [data-color='4']{
    fill:#0000ff;
  }
</style>
